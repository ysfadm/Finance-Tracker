<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Finance Tracker - Login</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
      }

      .container {
        width: 100%;
        max-width: 450px;
      }

      .card {
        background: white;
        border-radius: 15px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        overflow: hidden;
      }

      .card-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px 20px;
        text-align: center;
      }

      .card-header h1 {
        font-size: 28px;
        margin-bottom: 5px;
      }

      .card-header p {
        font-size: 14px;
        opacity: 0.9;
      }

      .card-body {
        padding: 30px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        color: #333;
        font-weight: 600;
        font-size: 14px;
      }

      input,
      select {
        width: 100%;
        padding: 12px 15px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 14px;
        transition: all 0.3s ease;
        font-family: inherit;
      }

      input:focus,
      select:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
      }

      .tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 25px;
        border-bottom: 2px solid #e0e0e0;
      }

      .tab-btn {
        flex: 1;
        padding: 12px;
        border: none;
        background: none;
        color: #999;
        font-weight: 600;
        cursor: pointer;
        border-bottom: 3px solid transparent;
        transition: all 0.3s ease;
      }

      .tab-btn.active {
        color: #667eea;
        border-bottom-color: #667eea;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      button {
        width: 100%;
        padding: 12px;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        margin-bottom: 15px;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      }

      .btn-secondary {
        background: #f0f0f0;
        color: #333;
        margin-top: 10px;
      }

      .btn-secondary:hover {
        background: #e0e0e0;
      }

      .message {
        padding: 12px 15px;
        border-radius: 8px;
        margin-bottom: 20px;
        display: none;
        font-size: 14px;
      }

      .message.success {
        background: #d4edda;
        color: #155724;
        display: block;
      }

      .message.error {
        background: #f8d7da;
        color: #721c24;
        display: block;
      }

      .admin-links {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 20px;
        padding-top: 20px;
        border-top: 2px solid #e0e0e0;
      }

      .admin-btn {
        padding: 10px !important;
        font-size: 12px !important;
        background: #f8f9fa !important;
        color: #666 !important;
        border: 2px solid #e0e0e0 !important;
        margin: 0 !important;
      }

      .admin-btn:hover {
        background: #e9ecef !important;
        border-color: #667eea !important;
      }

      .status-bar {
        background: #f8f9fa;
        padding: 15px;
        text-align: center;
        font-size: 12px;
        color: #666;
        border-top: 1px solid #e0e0e0;
      }

      .status-indicator {
        display: inline-block;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        margin-right: 5px;
        animation: pulse 2s infinite;
      }

      .status-indicator.active {
        background: #28a745;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
      }

      .error-text {
        color: #dc3545;
        font-size: 12px;
        margin-top: 5px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="card">
        <div class="card-header">
          <h1>üí∞ Finance Tracker</h1>
          <p>Personal Finance Management System</p>
        </div>

        <div class="card-body">
          <div class="message" id="message"></div>

          <!-- Tabs -->
          <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('login')">
              Login
            </button>
            <button class="tab-btn" onclick="switchTab('register')">
              Register
            </button>
          </div>

          <!-- Login Tab -->
          <div id="login" class="tab-content active">
            <form onsubmit="handleLogin(event)">
              <div class="form-group">
                <label>Email Address</label>
                <input
                  type="email"
                  id="loginEmail"
                  placeholder="your@email.com"
                  required
                />
              </div>

              <div class="form-group">
                <label>Password</label>
                <input
                  type="password"
                  id="loginPassword"
                  placeholder="Enter password"
                  required
                />
              </div>

              <button type="submit" class="btn-primary">Login</button>
            </form>
          </div>

          <!-- Register Tab -->
          <div id="register" class="tab-content">
            <form onsubmit="handleRegister(event)">
              <div class="form-row">
                <div class="form-group">
                  <label>First Name</label>
                  <input
                    type="text"
                    id="firstName"
                    placeholder="John"
                    required
                  />
                </div>
                <div class="form-group">
                  <label>Last Name</label>
                  <input type="text" id="lastName" placeholder="Doe" required />
                </div>
              </div>

              <div class="form-group">
                <label>Email Address</label>
                <input
                  type="email"
                  id="registerEmail"
                  placeholder="your@email.com"
                  required
                />
              </div>

              <div class="form-group">
                <label>Password</label>
                <input
                  type="password"
                  id="registerPassword"
                  placeholder="Min. 8 characters"
                  required
                  minlength="8"
                />
                <div class="error-text" id="passwordError"></div>
              </div>

              <div class="form-group">
                <label>Confirm Password</label>
                <input
                  type="password"
                  id="confirmPassword"
                  placeholder="Repeat password"
                  required
                />
              </div>

              <div class="form-group">
                <label>Currency</label>
                <select id="currency" required>
                  <option value="">Select Currency</option>
                  <option value="USD">USD - US Dollar</option>
                  <option value="EUR">EUR - Euro</option>
                  <option value="GBP">GBP - British Pound</option>
                  <option value="TRY">TRY - Turkish Lira</option>
                  <option value="JPY">JPY - Japanese Yen</option>
                </select>
              </div>

              <button type="submit" class="btn-primary">Create Account</button>
            </form>
          </div>

          <!-- Admin Panel Links -->
          <div class="admin-links">
            <a
              href="http://localhost:8080/api"
              target="_blank"
              class="btn-primary admin-btn"
              style="text-decoration: none"
              >üîå Backend API</a
            >
            <a
              href="http://localhost:8080/api/h2-console"
              target="_blank"
              class="btn-primary admin-btn"
              style="text-decoration: none"
              >üìä H2 Console</a
            >
            <a
              href="admin.html"
              class="btn-primary admin-btn"
              style="text-decoration: none"
              >üîê Admin Panel</a
            >
            <button class="btn-primary admin-btn" onclick="showApiDocs()">
              üìñ API Docs
            </button>
          </div>
        </div>

        <div class="status-bar">
          <span class="status-indicator active"></span>
          All systems running ‚Ä¢ Backend: <strong>8080</strong> ‚Ä¢ Frontend:
          <strong>3000</strong>
        </div>
      </div>
    </div>

    <script>
      const API_BASE = "http://localhost:8080/api";

      function switchTab(tab) {
        document
          .querySelectorAll(".tab-content")
          .forEach((el) => el.classList.remove("active"));
        document
          .querySelectorAll(".tab-btn")
          .forEach((el) => el.classList.remove("active"));
        document.getElementById(tab).classList.add("active");
        event.target.classList.add("active");
      }

      function showMessage(message, type) {
        const messageEl = document.getElementById("message");
        messageEl.textContent = message;
        messageEl.className = `message ${type}`;
        setTimeout(() => (messageEl.className = "message"), 5000);
      }

      function handleLogin(event) {
        event.preventDefault();
        const email = document.getElementById("loginEmail").value;
        const password = document.getElementById("loginPassword").value;

        fetch(`${API_BASE}/auth/login`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, password }),
        })
          .then((res) => res.json())
          .then((response) => {
            if (response.success && response.data && response.data.token) {
              localStorage.setItem("authToken", response.data.token);
              localStorage.setItem("user", JSON.stringify(response.data));
              showMessage("‚úÖ Login successful!", "success");
              setTimeout(() => (window.location.href = "dashboard.html"), 1500);
            } else {
              showMessage(
                "‚ùå " + (response.message || "Login failed"),
                "error"
              );
            }
          })
          .catch((err) => {
            console.error("Login error:", err);
            showMessage("‚ùå Connection error", "error");
          });
      }

      function handleRegister(event) {
        event.preventDefault();
        const password = document.getElementById("registerPassword").value;
        const confirmPassword =
          document.getElementById("confirmPassword").value;

        if (password !== confirmPassword) {
          showMessage("‚ùå Passwords do not match", "error");
          return;
        }

        const data = {
          email: document.getElementById("registerEmail").value,
          password: password,
          firstName: document.getElementById("firstName").value,
          lastName: document.getElementById("lastName").value,
          currency: document.getElementById("currency").value,
        };

        fetch(`${API_BASE}/auth/register`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data),
        })
          .then((res) => res.json())
          .then((response) => {
            if (response.success) {
              showMessage("‚úÖ Account created! Please login.", "success");
              document.getElementById("registerEmail").value = data.email;
              document.getElementById("registerPassword").value = "";
              document.getElementById("confirmPassword").value = "";
              setTimeout(() => switchTab("login"), 1500);
            } else {
              showMessage(
                "‚ùå " + (response.message || "Registration failed"),
                "error"
              );
            }
          })
          .catch((err) => {
            console.error("Register error:", err);
            showMessage("‚ùå Connection error", "error");
          });
      }

      function showApiDocs() {
        alert(
          "API Documentation:\n\nBase URL: http://localhost:8080/api\n\nEndpoints:\n- POST /auth/register\n- POST /auth/login\n- GET /users/{id}\n- GET /categories\n- GET /transactions\n\nSee backend documentation for details."
        );
      }
    </script>
  </body>
</html>
